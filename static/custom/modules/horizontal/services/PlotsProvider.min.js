define(function(){var PlotsProvider=function(dvtUtils,$document,$modal,$log){var colors=require("json!horizontal/model/colors"),setContainerTitleComposition=function(isMaximized,isEnlarged,shortD,longD,customShortTitle,customLongTitle){return isMaximized&&!isEnlarged?customLongTitle||longD:customShortTitle||shortD},plotsProvider=this;return plotsProvider.getDynamicColor=function(dataset){var dashboard=this.dashboard,color1=dashboard.getParameterValue("pColor1"),color2=dashboard.getParameterValue("pColor2"),colorEU=dashboard.getParameterValue("pColorEU"),country1=dashboard.getParameterValue("pCountry1"),country2=dashboard.getParameterValue("pCountry2");this.chartDefinition.colorMap={},this.chartDefinition.colorMap.EU=colorEU,"EU"!=country1&&(this.chartDefinition.colorMap[country1]=color1),"EU"!=country2&&(this.chartDefinition.colorMap[country2]=color2)},{getPlotBgColor:function(){return colors.plotsBg},getStoryConextualPlots:function(id){switch(id){case 6:return[{name:"main",visualRoles:{value:"PIB",series:"country",category:"year",color:{legend:{visible:!1}}},colorAxis:1,orthoAxis:1},{type:"point",linesVisible:!0,dotsVisible:!0,nullInterpolationMode:"linear",visualRoles:{value:"GDPgrouth",color:{legend:{visible:!1}}},colorAxis:2,orthoAxis:2}]}},getDynamicColor:plotsProvider.getDynamicColor,getHLYDynamicColor:function(dataset){var dashboard=this.dashboard,color1=dashboard.getParameterValue("pColor1"),color12=dashboard.getParameterValue("pColor12"),color2=dashboard.getParameterValue("pColor2"),color22=dashboard.getParameterValue("pColor22"),colorEU=dashboard.getParameterValue("pColorEU"),color2EU=dashboard.getParameterValue("pColorEU2"),country1=dashboard.getParameterValue("pCountry1"),country2=dashboard.getParameterValue("pCountry2"),colors={country1:[color1,color12],country2:[color2,color22],EU:[colorEU,color2EU]},indicators=[];dataset.resultset.forEach(function(element,array,index){$log.info(element[0]),indicators.indexOf(element[0])<0&&indicators.push(element[0])});var colorMap={};indicators.forEach(function(element,index,array){colorMap[country1+"~"+element]=colors.country1[index],colorMap[country2+"~"+element]=colors.country2[index],colorMap["EU~"+element]=colors.EU[index]}),this.chartDefinition.colorMap=colorMap},getHLYbarFillStyle:function(dashboard){return function(dataset){$log.debug("ISSUE##########################################################"),$log.debug(dataset);var color1=dashboard.parameters.pColor1,color12=dashboard.parameters.pColor12,color2=dashboard.parameters.pColor2,color22=dashboard.parameters.pColor22,colorEU=dashboard.parameters.pColorEU,color2EU=dashboard.parameters.pColorEU2,country1=dashboard.parameters.pCountry1,country2=dashboard.parameters.pCountry2,colors={country1:[color1,color12],country2:[color2,color22],EU:[colorEU,color2EU]},country=this.getCategory().length>2?dataset.firstAtoms.category2:this.getCategory(),indicator=this.getSeries();return indicator.indexOf("Difference")>-1||indicator.indexOf("LE")>-1?"EU"==country?colors.EU[0]:country==country1?colors.country1[0]:country==country2?colors.country2[0]:dvtUtils.getColorCountry(0):"EU"==country?colors.EU[1]:country==country1?colors.country1[1]:country==country2?colors.country2[1]:dvtUtils.getColorCountry(-1)}},showContextualData:function(metadata,definition,scope,attributes){var longD=scope.isMaximized&&scope.longTitle?scope.longTitle:"";(-1!=attributes.showTitle||!1)&&!scope.title&&(scope.title=setContainerTitleComposition(attributes.isMaximized,attributes.isEnlarged,"",longD,attributes.title,attributes.longTitle),definition.indTitle=scope.title),(attributes.showLegend||!1)&&(scope.functionalLegend=attributes.maxFunctionalLegend?attributes.maxFunctionalLegend:"",definition.functLegen=scope.functionalLegend)},setAxisXPercentFormat:function(scene){return this.delegate().concat("%")},setAxisYPercentFormat:function(scene){return this.pvMark.scene[0].textAlign="center",this.pvMark.scene[0].left=-5,this.delegate().concat("%")},paintPieLabel:function(){return[{valuesLabelStyle:"inside",valuesFont:'10px "sans-serif"',label_visible:function(){return!this.index},label_left:function(){return.9*this.delegate()},label_top:function(){return.94*this.delegate()},max_label_left:function(){return.91*this.delegate()},max_label_top:function(){return this.delegate()},label_textAngle:0,label_textStyle:"white",valuesMask:"{value}%",slice_fillStyle:function(){return 0===this.index?this.delegate():"lightgray"}}]},getDonoughtPlots:function(figure){switch(figure){case 3:return[{name:"main",dataPart:"0",valuesLabelStyle:"inside",valuesFont:'10px "sans-serif"',slice_innerRadiusEx:"50%",slice_strokeStyle:"white",slice_outerRadius:function(){return.65*this.delegate()},label_visible:function(){return!this.index},label_left:function(){return.9*this.delegate()},label_top:function(){return.94*this.delegate()},max_label_left:function(){return.91*this.delegate()},max_label_top:function(){return this.delegate()},label_textAngle:0,label_textStyle:"white",valuesMask:"{value}%",slice_fillStyle:function(){return 0===this.index?this.delegate():"lightgray"}},{name:"inner",type:"pie",dataPart:"1",valuesLabelStyle:"inside",valuesFont:'10px "sans-serif"',slice_innerRadiusEx:"65%",slice_strokeStyle:"white",label_visible:function(){return!this.index},label_left:function(){return.9*this.delegate()},label_top:function(){return.97*this.delegate()},max_label_left:function(){return.9*this.delegate()},max_label_top:function(){return.97*this.delegate()},label_textAngle:0,label_textAlign:"center",label_textBaseline:"middle",valuesMask:"{value}%",colorAxis:2,slice_fillStyle:function(){return 0===this.index?this.delegate():"lightgray"}}];default:return null}},getCalculations:function(figure,country){switch(figure){case 7:return[{names:"dataPart",calculation:function(datum,out){var series=datum.atoms.series.value;out.dataPart=series==country?"0":"1"}}];case 3:return[{names:"dataPart",calculation:function(datum,out){var series=datum.atoms.series.value;out.dataPart="EU"==series?"0":"1"}}];default:return null}},getDonutsDynamicColor:function(dataset){this.chartDefinition.colorRole="series",plotsProvider.getDynamicColor.apply(this)}}};return PlotsProvider.$inject=["dvtUtils","$document","$modal","$log"],PlotsProvider});