define(function(require){"use strict";function controller($scope,$window,$stateParams,$state,$log,dvtUtils,dataService,plotsProvider,$document,configService,$http){$scope.title="About the Visualisation Tool",$scope.cda=configService.getBarometerCda();var i18nLiterals=configService.getLiterals();if($scope.i18nLiterals=i18nLiterals,$scope.currentState=$state.current.name,$scope.pSection=$stateParams.pSection,$scope.pSubsection=$stateParams.pSubsection,$scope.pIndicator=$stateParams.pIndicator,$scope.sections=[{id:"generic-information",name:"L22001",firstSubsection:"osh_authorities",firstIndicatorId:"27"},{id:"osh-steering",name:"L22005",firstSubsection:"structure_strategy",firstIndicatorId:"46"},{id:"osh-outcomes-working-conditions",name:"L22009",firstSubsection:"workacc",firstIndicatorId:"53"},{id:"osh-infrastructure",name:"L22016",firstSubsection:"enforcement_capacity",firstIndicatorId:"285"}],$scope.subsections=[],$scope.indicators=[],$scope.data=void 0,"about-tool-detail-page"==$scope.currentState){var path=configService.getHorizontalDirectiveDataPath("main-menu","menu");$http.get(path,{data:"",headers:{"Content-Type":"application/json"}}).success(function(menuStructure){$scope.structure=menuStructure;for(var i=0;i<$scope.structure.length;i++)if($scope.structure[i].id==$scope.pSection){$scope.subsections=$scope.structure[i].levels,$log.warn($scope.subsections);for(var j=0;j<$scope.subsections.length;j++)$log.warn($scope.subsections[j].database_name),void 0!=$scope.subsections[j].database_name&&($scope.subsections[j].database_name=$scope.subsections[j].database_name.toLowerCase()),$log.warn($scope.subsections[j].database_name),""!=$scope.subsections[j].database_name&&void 0!=$scope.subsections[j].database_name||($scope.subsections.splice(j,1),j-=1);break}}),dataService.getMethodologyIndicators($scope.pSubsection.toUpperCase()).then(function(data){data.data.resultset.map(function(elem){$stateParams.filter&&$stateParams.filter;$scope.indicators.push({id:elem[0],anchor:i18nLiterals["L"+elem[1]].toLowerCase().replace(/ /g,"-"),text:elem[1]})})}).catch(function(err){throw err}),dataService.getMethodologyData($scope.pIndicator,$scope.pSubsection.toUpperCase()).then(function(data){data.data.resultset.map(function(elem){$scope.data={diagram:elem[0],description:elem[1],datasource:elem[2],specific_table:elem[3],url:elem[4],options_applied:elem[5],reference_year:elem[6],last_update:elem[7],coverage:elem[8],unit_measure:elem[9],calculations:elem[10],visualisation:elem[11],additional_comments:elem[12]}})}).catch(function(err){throw err})}$scope.changeSection=function(id){for(var i=0;i<$scope.structure.length;i++)if($scope.structure[i].id==id){$scope.subsections=$scope.structure[i].levels;for(var j=0;j<$scope.subsections.length;j++)""==$scope.subsections[j].database_name&&$scope.subsections.splice(j,1)}$log.warn($scope.subsections)},$scope.getIndicators=function(subsection){dataService.getMethodologyIndicators(subsection.database_name).then(function(data){data.data.resultset.map(function(elem){$stateParams.filter&&$stateParams.filter;$scope.indicators.push({id:elem[0],anchor:i18nLiterals["L"+elem[1]].toLowerCase().replace(/ /g,"-"),text:elem[1]})}),$log.warn($scope.indicators)}).catch(function(err){throw err})},$scope.changeIndicator=function(indicator){$log.warn(indicator),$state.transitionTo($scope.currentState,{pSection:$scope.pSection,pSubsection:$scope.pSubsection,pIndicator:indicator},{reload:!0})},$scope.indicatorIcons=function(subsection){switch(subsection=subsection.toLowerCase()){case"osh_authorities":return"forum-icon";case"economic_sector_profile":return"economic-chart-icon";case"workforce_profile":return"people-group-icon";case"regulation":return"regulation-icon";case"structure_strategy":case"response_strategy":return"national-icon";case"social_dialogue":return"dialogue-icon";case"workacc":return"work-accidents-icon";case"health_perception":return"health-icon";case"osh_culture_health_awareness":return"culture-icon";case"overall_opinion":return"overall-opinion-icon";case"mental_risks":return"mental-risk-icon";case"physical_risks":return"physical-risk-icon";case"prevention_in_companies":return"prevention-icon";case"worker_involvement":return"workers-icon";case"enforcement_capacity":return"enforcement-icon";case"osh_statistics":return"statistics-icon"}},$(window).on("resize",function(e){resolution=$(window).width()}),resolution=$(window).width(),$scope.openIndicatorsList=function(e){if(resolution<990){e.currentTarget;angular.element(".indicators--submenu--wrapper").toggleClass("open-list")}},$("body").on("click touchstart",function(e){var container=angular.element(".indicators--submenu--wrapper");container.is(e.target)||0!==container.has(e.target).length||angular.element(".indicators--submenu--wrapper").removeClass("open-list")}),$scope.status="ready"}return controller.$inject=["$scope","$window","$stateParams","$state","$log","dvtUtils","dataService","plotsProvider","$document","configService","$http"],controller});