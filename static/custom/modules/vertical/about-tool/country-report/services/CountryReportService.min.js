define(function(require){var configService=require("horizontal/config/configService"),pv=require("cdf/lib/CCC/protovis"),CountryReportService=function(dvtUtils,$log){return{getChartAllCountriesPlots:function(pCountry){return[{name:"main",dataPart:"0",line_lineWidth:1.5,barSizeMax:20,bar_call:function(){54!=this.sign.chart.options.datasourceAndDates[1]&&(this.add(pv.Rule).top(0).bottom(0).height(null).width(null).strokeStyle("black").lineWidth(2.5).left(function(scene){var baseScale=this.getContext().chart.axes.base.scale;scene.firstAtoms.category,this.root.width();return baseScale("Austria (AT)")-10}),this.add(pv.Rule).top(0).bottom(0).height(null).width(null).strokeStyle("black").lineWidth(2.5).left(function(scene){var baseScale=this.getContext().chart.axes.base.scale;scene.firstAtoms.category,this.root.width();return scene.firstAtoms.value.label.match("%")||(scene.firstAtoms.value.label=scene.firstAtoms.value.label+"%"),resolution<960?baseScale("Switzerland (CH)")-11:baseScale("Switzerland (CH)")-this.sign.panel.barWidth/2}))},bar_fillStyle:function(scene){var countryKey=scene.firstAtoms.category.value,split=scene.firstAtoms.series.value,splits=[];358==this.chart.options.datasourceAndDates[1]?splits=["Regularly","Occasionally","Practically never"]:328==this.chart.options.datasourceAndDates[1]||329==this.chart.options.datasourceAndDates[1]||330==this.chart.options.datasourceAndDates[1]||331==this.chart.options.datasourceAndDates[1]||323==this.chart.options.datasourceAndDates[1]||324==this.chart.options.datasourceAndDates[1]||325==this.chart.options.datasourceAndDates[1]||326==this.chart.options.datasourceAndDates[1]||327==this.chart.options.datasourceAndDates[1]||89==this.chart.options.datasourceAndDates[1]?splits=["Yes","No"]:63==this.chart.options.datasourceAndDates[1]?splits=["Yes, and I always use it","Yes, but I don't always use it","No, not required"]:64==this.chart.options.datasourceAndDates[1]?splits=["(very) Well informed","Not very or not at all well informed"]:65==this.chart.options.datasourceAndDates[1]?splits=["Very satisfied","Satisfied","Not very satisfied","Not at all satisfied"]:83==this.chart.options.datasourceAndDates[1]||87==this.chart.options.datasourceAndDates[1]?splits=["(Almost) all of the time","Between 1/4 and 3/4 of the time","(Almost) never"]:85==this.chart.options.datasourceAndDates[1]?splits=["Always or most of the time","Sometimes","Rarely or never"]:86==this.chart.options.datasourceAndDates[1]?splits=["Agree","Neither agree nor disagree","Disagree"]:88==this.chart.options.datasourceAndDates[1]?splits=["Once or more","Never"]:71==this.chart.options.datasourceAndDates[1]||72==this.chart.options.datasourceAndDates[1]||73==this.chart.options.datasourceAndDates[1]||74==this.chart.options.datasourceAndDates[1]?splits=["At least 1/4 of the time","Less than 1/4 of the time"]:305==this.chart.options.datasourceAndDates[1]?splits=["Conducted mainly by internal staff","Contracted mainly to external providers","Both about equally"]:360==this.chart.options.datasourceAndDates[1]&&(splits=["Yes","Yes, but only some of them","No"]),"getLevelOfReportingData"==this.chart.options.dataAccessId&&(scene.firstAtoms.value.label.match("%")||(scene.firstAtoms.value.label=scene.firstAtoms.value.label+"%"));var EUColours=[dvtUtils.getEUColor(),dvtUtils.getEUColor(2),dvtUtils.getChartLightGrayColor(),dvtUtils.getAccidentsColors(4)],countryColours=[dvtUtils.getColorCountry(1),dvtUtils.getColorCountry(12),dvtUtils.getChartLightGrayColor(),dvtUtils.getAccidentsColors(4)],defaultColours=[dvtUtils.getColorCountry(2),dvtUtils.getColorCountry(22),dvtUtils.getChartLightGrayColor(),dvtUtils.getAccidentsColors(4)];return"EU28"==countryKey||"EU27_2020"==countryKey?0==splits.length?dvtUtils.getEUColor():EUColours[splits.indexOf(split)]:countryKey.indexOf(pCountry)>-1?0==splits.length?dvtUtils.getColorCountry(1):countryColours[splits.indexOf(split)]:0==splits.length?dvtUtils.getColorCountry(2):defaultColours[splits.indexOf(split)]},label_textStyle:function(scene){return"EU28"==scene.firstAtoms.series?dvtUtils.getEUColor():dvtUtils.getChartLightGrayColor()},visualRoles:{series:"series",category:"category"}}]},getCompanySizeMainPlots:function(pCountry){this.dashboard;return[{name:"main",dataPart:"0",valuesOverflow:"show",label_textStyle:function(scene){var subIndicatorKey=scene.firstAtoms.series,country=scene.firstAtoms.category;if(scene.firstAtoms.value.label.match("%")||(scene.firstAtoms.value.label=scene.firstAtoms.value.label+"%"),""!=subIndicatorKey){if("From 0 to 9 persons employed"==subIndicatorKey)return dvtUtils.getColorCountry(1);if("From 10 to 19 persons employed"==subIndicatorKey)return dvtUtils.getColorCountry(22);if("From 20 to 49 persons employed"==subIndicatorKey)return dvtUtils.getAccidentsColors(4);if("From 50 to 249 persons employed"==subIndicatorKey)return dvtUtils.getColorCountry(3);if("250 persons employed or more"==subIndicatorKey)return dvtUtils.getColorCountry(2)}else{if("EU28"==country)return dvtUtils.getEUColor();if(country.label.match(pCountry))return dvtUtils.getColorCountry(1)}return dvtUtils.getChartLightGrayColor()},label_textMargin:2,valuesAnchor:"right",valuesOptimizeLegibility:!0,visualRoles:{series:"series",category:"category"}}]},getGPDMainPlots:function(pCountry1){return[{name:"main",dataPart:"0",bar_visible:"true",bar_fillStyle:"#f0f0f0",label_textStyle:"dimgray",label_textMargin:2,label_textBaseline:"center",valuesOptimizeLegibility:!1,valuesAnchor:"bottom",valuesOverflow:"show",overflowMarkersVisible:!1,bar_call:function(){this.add(pv.Image).url(function(scene){var countryKey=scene.firstAtoms.category;return countryKey.label.match(pCountry1)?configService.getImagesPath()+"man_orange.svg":"EU28"==countryKey?configService.getImagesPath()+"man_blue.svg":void 0}).bottom(20).height(function(scene){var axisFixedMax=this.root.sign.chart.options.axisFixedMax,panelHeight=this.root.height(),valueKey=scene.firstAtoms.value,resul=valueKey*(panelHeight-this.bottom())/axisFixedMax;return valueKey>=220&&(this.root.sign.chart.options.axisFixedMax=420),resul}).width(function(scene){scene.firstAtoms.value;return.45333*this.height()}).left(function(scene){var panelWidth=this.root.width(),barWidth=panelWidth/3.5,countryKey=scene.firstAtoms.category;if(300!=panelWidth){if(countryKey.label.match(pCountry1))return(barWidth-this.width())/2+5;if("EU28"==countryKey){return null==scene.previousSibling?panelWidth/2+this.width()/1.5:panelWidth/1.5+(barWidth-this.width())/2-5}}}).events("all").cursor("hand")},visualRoles:{category:"category"}}]},getIncomeMainPlots:function(pCountry1){this.dashboard;return[{name:"main",dataPart:"0",line_lineWidth:function(scene){var countryValue=scene.firstAtoms.value;return countryValue.value>parseInt(this.sign.chart.options.orthoAxisFixedMax)&&(this.sign.chart.options.orthoAxisFixedMax=countryValue.value),countryValue.value<parseInt(this.chart.options.orthoAxisFixedMin)&&(this.chart.options.orthoAxisFixedMin=countryValue.value),1.5},label_textStyle:function(scene){var countryKey=scene.firstAtoms.series;return"EU28"==countryKey?dvtUtils.getEUColor():countryKey.label.match(pCountry1)?dvtUtils.getColorCountry(1):dvtUtils.getChartLightGrayColor()},label_textMargin:function(scene){var countryKey=scene.firstAtoms.series;return"EU28"==countryKey?5:countryKey.label.match(pCountry1)?8:void 0},label_textBaseline:function(scene){var countryKey=scene.firstAtoms.series,countryYear=(scene.firstAtoms.value,scene.firstAtoms.category),resultset=this.chart.resultset;if(4==resultset.length){countryKey.label.match(pCountry1)&&(this.sign.chart.options.colors=[dvtUtils.getColorCountry(1),dvtUtils.getEUColor()]);var country1Value1=this.chart.resultset[0][2],country1Value2=this.chart.resultset[1][2],euValue1=this.chart.resultset[2][2],euValue2=this.chart.resultset[3][2],difference3=country1Value1-euValue1<1e3&&country1Value1-euValue1>0||country1Value1-euValue1>-1e3&&country1Value1-euValue1<0,difference4=country1Value2-euValue2<1e3&&country1Value2-euValue2>0||country1Value2-euValue2>-1e3&&country1Value2-euValue2<0;return"EU28"==countryKey?difference3&&"2010"==countryYear?"bottom":difference4&&"2018"==countryYear?"bottom":"top":"top"}if(2==resultset.length)return this.sign.chart.options.colors=[dvtUtils.getEUColor()],"top"},visualRoles:{series:"series",category:"category"}}]},getHealthAtRiskPlots:function(pCountry1){return[{name:"main",dataPart:"0",barSizeMax:35,label_textMargin:7,label_textBaseline:"bottom",valuesAnchor:"top",valuesOptimizeLegibility:!0,label_textStyle:function(scene){var countryKey=scene.firstAtoms.series,valueKey=scene.firstAtoms.value;return scene.firstAtoms.value.label.match("%")||(scene.firstAtoms.value.label=scene.firstAtoms.value.label+"%"),valueKey.value>parseInt(this.sign.chart.options.orthoAxisFixedMax)&&(this.sign.chart.options.orthoAxisFixedMax=valueKey.value),"EU28"==countryKey||"EU27_2020"==countryKey?dvtUtils.getEUColor():countryKey.value.match(pCountry1)?dvtUtils.getColorCountry(1):dvtUtils.getChartLightGrayColor()},visualRoles:{series:"series",category:"category"}}]},getGeneralOSHInfrastructurePlot:function(pCountry1){return[{name:"main",dataPart:"0",barSizeMax:80,barSizeRatio:.6,bar_fillStyle:function(scene){var answer=scene.firstAtoms.series.value,country=-1==scene.firstAtoms.category.value.indexOf("(")?scene.firstAtoms.category.value.indexOf("("):scene.firstAtoms.category.value.substring(1,3);return"Yes"==answer?country==pCountry1?dvtUtils.getColorCountry(1):dvtUtils.getEUColor():"No"==answer?country==pCountry1?dvtUtils.getColorCountry(12):dvtUtils.getEUColor(2):dvtUtils.getChartLightGrayColor()},label_textMargin:7,label_textBaseline:"bottom",valuesAnchor:"middle",valuesOptimizeLegibility:!0,visualRoles:{series:"series",category:"category",value:"value"}}]}}};return CountryReportService.$inject=["dvtUtils","$log"],CountryReportService});