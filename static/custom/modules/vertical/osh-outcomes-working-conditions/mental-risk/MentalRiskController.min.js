var resolution=screen.width;define(function(require){"use strict";function controller($scope,$stateParams,$state,configService,$log,$document,dataService,$window,$sce,$compile,$timeout,dvtUtils,MentalRiskService,$rootScope){$scope.cdaOSHOutcomes=configService.getOshOutcomesWorkingConditionsCda();var i18nLiterals=configService.getLiterals();$scope.i18nLiterals=i18nLiterals,$scope.datasetList=configService.getDatasets(),$scope.datasetEurofound=$scope.datasetList.Eurofound,$scope.datasetESENER=$scope.datasetList.ESENER,$scope.countriesDataFor=[],$scope.countriesCompareWith=[],$scope.pSplit=$stateParams.pDataset,$scope.indicators=[];var resolution=window.resolution;$scope.resolution=resolution,$scope.orientation=resolution>768?"vertical":"horizontal",$scope.axisSize=resolution>768?150:120,$scope.angle=resolution>768?1:0,$scope.horizontalHeight=resolution>768?470:770,$scope.axisFixedMin=resolution>768?60:0,$scope.query=resolution>768?"getMentalRiskVerticalData":"getMentalRiskHorizontalData",$scope.timePressureQuery=resolution>768?"getTimePressureEurofoundVerticalData":"getTimePressureEurofoundHorizontalData",$scope.poorCommunicationQuery=resolution>768?"getEurofoundPoorCommunicationVerticalData":"getEurofoundPoorCommunicationHorizontalData",$scope.influenceQuery=resolution>768?"getInfluenceEurofoundVerticalData":"getInfluenceEurofoundHorizontalData",$scope.jobInsecurity=resolution>768?"getJobInsecurityEurofoundVerticalData":"getJobInsecurityEurofoundHorizontalData",$scope.discriminationQuery=resolution>768?"getEurofoundDiscriminationVerticalData":"getEurofoundDiscriminationHorizontalData",$scope.eurofoundQuery=resolution>768?"getEurofoundVerticalData":"getEurofoundHorizontalData",$scope.color1=resolution>768?dvtUtils.getColorCountry(22):dvtUtils.getColorCountry(1),$scope.color2=resolution>768?dvtUtils.getColorCountry(1):dvtUtils.getColorCountry(22),$scope.color3=resolution>768?dvtUtils.getAccidentsColors(4):dvtUtils.getColorCountry(1),$scope.color4=resolution>768?dvtUtils.getColorCountry(1):dvtUtils.getAccidentsColors(4),$(window).on("resize",function(e){window.outerWidth!=resolution&&(resolution=window.resolution,$state.reload())}),$scope.pIndicator=$stateParams.pIndicator,void 0!=$rootScope.defaultCountry?$scope.pCountry1=$rootScope.defaultCountry.code:$scope.pCountry1=$rootScope.defaultCountryDefaultValue,void 0!=$rootScope.defaultCountry2?$scope.pCountry2=$rootScope.defaultCountry2.code:$scope.pCountry2=0,$scope.dashboard={},$scope.dashboard={parameters:{pCountry1:$scope.pCountry1,pCountry2:$scope.pCountry2}},$scope.relatedItems={"time-pressure":[{title:"L20674",text:"L20578",link:"mental-risk({pIndicator:'working-hours', pSplit:'"+$scope.pSplit+"'})",icon:"mental-risk"}],"poor-communication":[{title:"L20682",text:"L22058",link:"prevention-companies({pIndicator:'training-in-osh'})",icon:"prevention"},{title:"L22015",text:"L22060",link:"worker-involvement({pSplit:'"+$scope.pSplit+"'})",icon:"workers"}],influence:[{title:"L22015",text:"L22060",link:"worker-involvement({pSplit:'ewcs'})",icon:"workers"},{title:"L322",text:"L20577",link:"overall-opinion",icon:"overall-opinion"}],"fear-of-job-loss":[{title:"L22008",text:"L22041",link:"social-dialogue",icon:"mental-risk"},{title:"L322",text:"L20577",link:"overall-opinion",icon:"overall-opinion"}],"difficult-clients":[{title:"L20667",text:"L22054",link:"osh-culture({pIndicator:'procedures-to-deal-with-threats'})",icon:"culture"},{title:"L20709",text:"L20577",link:"overall-opinion",icon:"overall-opinion"}],"working-hours":[{title:"L20665",text:"L22054",link:"osh-culture({pIndicator:'action-plan-to-prevent-stress'})",icon:"culture"},{title:"L22003",text:"L22028",link:"economic-sector-profile",icon:"economic-chart"}],discrimination:[{title:"L20666",text:"L22054",link:"osh-culture({pIndicator:'procedure-against-bullying'})",icon:"culture"},{title:"L20667",text:"L22054",link:"osh-culture({pIndicator:'procedures-to-deal-with-threats'})",icon:"culture"},{title:"L22004",text:"L22030",link:"workforce-profile",icon:"people-group"}]};$scope.stories=[{color1:dvtUtils.getColorCountry(1),color2:dvtUtils.getColorCountry(22),color3:dvtUtils.getAccidentsColors(4),plots:MentalRiskService.getESENERMentalRiskPlot(),dimensions:{value:{format:{number:"0.#",percent:"#%"}}}},{color1:dvtUtils.getColorCountry(1),plots:MentalRiskService.getPoorCommunicationPlot(),dimensions:{value:{format:{number:"0.#",percent:"#%"}}}},{color1:resolution>768?dvtUtils.getAccidentsColors(4):dvtUtils.getColorCountry(1),color2:dvtUtils.getColorCountry(22),color3:resolution>768?dvtUtils.getColorCountry(1):dvtUtils.getAccidentsColors(4),plots:MentalRiskService.getEurofoundMentalRiskPlot(),plotsEU:MentalRiskService.getEUEurofoundMentalRiskPlot(),dimensions:{value:{format:{number:"0.#",percent:"#%"}}}}],$scope.step={chart1:20,chart2:20},angular.element("div.countries-filters").css("display","none"),angular.element("#filter2 h2").addClass("showChallenges"),$scope.toggleFilters=function(){$window.outerWidth<768&&(angular.element("#filter2 h2").toggleClass("showChallenges"),angular.element("div.countries-filters").slideToggle("slow"))},console.log("column--item --\x3e"+angular.element(".column--item").length),angular.element("div.countries-filters").css("display","none"),angular.element("#filter2 h2").addClass("showChallenges"),$scope.toggleFilters=function(){$window.outerWidth<768&&(angular.element("#filter2 h2").toggleClass("showChallenges"),angular.element("div.countries-filters").slideToggle("slow"))},dataService.getMentalRiskIndicators().then(function(data){data.data.resultset.map(function(elem){$scope.indicators.push({id:elem[0],anchor:i18nLiterals["L"+elem[1]].toLowerCase().replace(/[\,\ ]/g,"-"),text:elem[1]})})}).catch(function(err){throw err}),$(window).on("resize",function(e){resolution=$(window).width()}),resolution=$(window).width(),$scope.openIndicatorsList=function(e){if(resolution<990){if("LI"==e.target.parentElement.nodeName)var parentTag=e.target.parentElement.parentElement.className;else var parentTag=e.target.parentElement.className;parentTag.indexOf("open-list")<0?angular.element(".submenu--items--wrapper").addClass("open-list"):angular.element(".submenu--items--wrapper").removeClass("open-list")}},$("body").on("click touchstart",function(e){var container=angular.element(".submenu--items--wrapper");container.is(e.target)||0!==container.has(e.target).length||angular.element(".submenu--items--wrapper").removeClass("open-list")}),$scope.changeIndicator=function(e,indicator){if(void 0!==$state.current.name){var dataset="influence"==indicator||"discrimination"==indicator?"ewcs":"esener";$state.go($state.current.name,{pIndicator:indicator,pDataset:dataset})}},$scope.changeDataset=function(indicator,dataset){$(".card--block--chart--wrapper").css("visibility","hidden"),void 0!==$state.current.name&&$state.go($state.current.name,{pIndicator:indicator,pDataset:dataset})}}return controller.$inject=["$scope","$stateParams","$state","configService","$log","$document","dataService","$window","$sce","$compile","$timeout","dvtUtils","MentalRiskService","$rootScope"],controller});