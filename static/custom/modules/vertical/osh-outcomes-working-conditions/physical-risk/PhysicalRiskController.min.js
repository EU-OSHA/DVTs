define(function(require){"use strict";function controller($scope,$stateParams,$state,configService,$log,$document,dataService,$window,$sce,$compile,$timeout,dvtUtils,PhysicalRiskService,exportService,$rootScope){$scope.cdaOSHOutcomes=configService.getOshOutcomesWorkingConditionsCda();var i18nLiterals=configService.getLiterals();$scope.i18nLiterals=i18nLiterals,$scope.datasetList=configService.getDatasets(),$scope.datasetEurofound=$scope.datasetList.Eurofound,$scope.datasetESENER=$scope.datasetList.ESENER,$scope.countriesDataFor=[],$scope.countriesCompareWith=[],$scope.indicators=[{anchor:"vibrations-loud-noise-and-temperature",text:"20654"},{anchor:"exposure-to-dangerous-substances",text:"20655"},{anchor:"risks-involve-with-work",text:"20656"}],$scope.subIndicators=[{anchor:"smoke-powder-or-dust",text:"328"},{anchor:"vapours",text:"329"},{anchor:"chemical-products",text:"330"},{anchor:"infectious-materials",text:"331"}],$scope.pIndicator=$stateParams.pIndicator,$scope.pSubIndicator=$stateParams.pSubIndicator,$scope.pCountry1=$stateParams.pCountry1,$scope.pCountry2=$stateParams.pCountry2,$scope.pFilter=$stateParams.pFilter;var resolution=window.resolution;$scope.resolution=resolution,$scope.angle=resolution>768?1:0,$scope.horizontalHeight=resolution>768?470:770,$scope.orientation=resolution>768?"vertical":"horizontal",$scope.axisSize=resolution>768?150:110,$scope.query=resolution>768?"getPhysicalRiskVerticalData":"getPhysicalRiskHorizontalData",$scope.color1=resolution>768?dvtUtils.getColorCountry(22):dvtUtils.getColorCountry(1),$scope.color2=resolution>768?dvtUtils.getColorCountry(1):dvtUtils.getColorCountry(22),$scope.selectCountryQuery="ewcs"==$scope.pSubIndicator?"getEurofoundRisksCountries":"getESENERRisksCountries",$scope.selectCountryDataset="ewcs"==$scope.pSubIndicator?$scope.datasetEurofound:$scope.datasetESENER,$(window).on("resize",function(e){window.outerWidth!=resolution&&(resolution=window.resolution,$state.reload())}),$scope.dashboard={},$scope.dashboard={parameters:{pCountry1:$scope.pCountry1,pCountry2:$scope.pCountry2}},$scope.relatedItems={"exposure-to-dangerous-substances":[{title:"L320",text:"L22054",link:"osh-culture({pIndicator:'use-of-personal-protective-equipment'})",icon:"culture"}]};$scope.stories=[{plots:PhysicalRiskService.getInfoAboutRisksData(),promises:{story1:[dataService.getCountry1VibrationData($scope.datasetEurofound,$scope.pCountry1),dataService.getCountry2VibrationData($scope.datasetEurofound,$scope.pCountry2),dataService.getEU28VibrationData($scope.datasetEurofound)]},dimensions:{value:{format:{number:"0.#",percent:"#%"}}}},{promises:{story1:[dataService.getCountryRisksInvolvedEurofoundData($scope.datasetEurofound,$scope.pCountry1),dataService.getCountryRisksInvolvedEurofoundData($scope.datasetEurofound,$scope.pCountry2),dataService.getEU28RisksInvolvedEurofoundData($scope.datasetEurofound)],story2:[dataService.getCountryRisksInvolvedESENERData($scope.datasetESENER,$scope.pCountry1),dataService.getCountryRisksInvolvedESENERData($scope.datasetESENER,$scope.pCountry2),dataService.getEU28RisksInvolvedESENERData($scope.datasetESENER)]}}],$scope.step=20,angular.element("div.countries-filters").css("display","none"),angular.element("#filter2 h2").addClass("showChallenges"),$scope.toggleFilters=function(){$window.outerWidth<768&&(angular.element("#filter2 h2").toggleClass("showChallenges"),angular.element("div.countries-filters").slideToggle("slow"))},angular.element("div.countries-filters").css("display","none"),angular.element("#filter2 h2").addClass("showChallenges"),$scope.toggleFilters=function(){$window.outerWidth<768&&(angular.element("#filter2 h2").toggleClass("showChallenges"),angular.element("div.countries-filters").slideToggle("slow"))},$(window).on("resize",function(e){resolution=$(window).width()}),resolution=$(window).width(),$scope.openIndicatorsList=function(e){if(resolution<990){if("LI"==e.target.parentElement.nodeName)var parentTag=e.target.parentElement.parentElement.className;else var parentTag=e.target.parentElement.className;parentTag.indexOf("open-list")<0?parentTag.indexOf("level2")<0?angular.element(".level1").addClass("open-list"):angular.element(".level2").addClass("open-list"):parentTag.indexOf("level2")<0?angular.element(".level1").removeClass("open-list"):angular.element(".level2").removeClass("open-list")}},$("body").on("click touchstart",function(e){var container=angular.element(".submenu--items--wrapper");container.is(e.target)||0!==container.has(e.target).length||angular.element(".submenu--items--wrapper").removeClass("open-list")}),$scope.changeIndicator=function(e,indicator,subIndicator,pChangeRoot){void 0!==$state.current.name&&(pChangeRoot&&($rootScope.defaultCountry.isCookie||($rootScope.defaultCountry.code=$scope.pCountry1),"0"!=$scope.pCountry2&&($rootScope.defaultCountry2={code:$scope.pCountry2,isCookie:0})),"exposure-to-dangerous-substances"==indicator?$state.go("physical-risk-exposure-to-dangerous-substances",{pIndicator:indicator,pSubIndicator:subIndicator,pFilter:$scope.pFilter,pCountry1:$scope.pCountry1,pCountry2:$scope.pCountry2}):"vibrations-loud-noise-and-temperature"==indicator?$state.go("physical-risk-vibrations-loud-noise-and-temperature",{pIndicator:indicator,pSubIndicator:subIndicator,pFilter:$scope.pFilter,pCountry1:$scope.pCountry1,pCountry2:$scope.pCountry2}):$state.go("physical-risk-risks-involved-with-work",{pIndicator:indicator,pSubIndicator:subIndicator,pFilter:$scope.pFilter,pCountry1:$scope.pCountry1,pCountry2:$scope.pCountry2}))},$scope.changeSplit=function(){$(".card--block--chart--wrapper").css("visibility","hidden"),void 0!==$state.current.name&&$state.transitionTo("physical-risk-risks-involved-with-work",{pIndicator:$scope.pIndicator,pSubIndicator:$scope.pSubIndicator,pFilter:$scope.pFilter,pCountry1:$scope.pCountry1,pCountry2:$scope.pCountry2},{reload:!0})},$scope.exportData=function(promises,title,id){exportService.exportRadarData(promises,title,id)},$scope.datasetMethodology=function(){if("risks-involve-with-work"==$scope.pIndicator)return"esener"==$scope.pFilter?$scope.datasetESENER:$scope.datasetEurofound}}return controller.$inject=["$scope","$stateParams","$state","configService","$log","$document","dataService","$window","$sce","$compile","$timeout","dvtUtils","PhysicalRiskService","exportService","$rootScope"],controller});